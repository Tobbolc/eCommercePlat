# eCommercePlat - ai数字经济学结课作业其一
#### 一个基于Django的全栈电商平台项目，支持全局（未登录）、买家、卖家和管理员4种角色

#### 技术栈 - Django、JavaScript、css
#### 包依赖 - 见项目内requirements.txt
（保证100%原创）
## 🎯 项目重点

项目着重渲染了以下核心页面：
- **商品展示页**（买家视角）
- **商品详情页**（买家视角）  
- **商品管理页**（卖家视角）
- **订单详情页**（买家视角）
- **订单处理页**（卖家视角）
- **卖家主页**

## 🚧 待优化功能

- 更清晰合理的命名，更好地区分卖家与买家功能
- 实现同一商品无限制下单功能
- 邮箱验证码登录（使用Ajax和`.val()`方法）
- ckeditor5的配置与使用优化
- 无限制评论的具体原理和样式美化

## 💡 开发感悟

### 技术洞察
- 卖家ID、标签和商品标签三者对应，大大简化了数据查询步骤
- 多加注释，规范化编程习惯很重要

### 概念理解加深
- `.all()` 等价于一个列表对象，在前端调用需要用for循环遍历
- `.first()` 直接是一个queryset，可以直接调用字段

### 新技术掌握
- 前端for循环时对象为空可以用 `{% empty %}`
- Ajax的进阶用法
- URL路径解析技巧
- Ajax对象URL中含有前端变量时的写法
- 使用 `window.location.href = path` 在alert后重定向

## 👥 角色功能详述

### 角色0：全局（未登录）

#### 核心功能
- **首页展示**：包含一个 `index.html`
- **分页器组件**：自写分页器组件，功能齐全，支持跳转页功能（已打包成组件）
- **搜索功能**：自写搜索功能（在URL上添加GET请求参数），支持部分关键字搜索
- **商品展示**：前端展示商品图片（配置 `{{MEDIA_URL}}`）、名称、单价（小数点后两位）
- **库存控制**：商品库存为0时显示售罄按钮，不可下单；未选择自动下架
- **推荐算法**：基于用户点击量倒序展示商品（未在前端展示点击量数据）
- **登录提示**：未登录点击下单会有响应提示

### 角色1：买家

#### 1. 鉴权认证
- **登录界面**：使用图片验证码，基于Form实现
- **用户注册**：输入用户名、密码、邮箱、手机号，使用ModelForm
- **数据验证**：利用 `form.is_valid()` 验证数据有效性
- **密码找回**：通过session存储用户名状态，使用Django自带邮件功能发送验证码
- **密码修改**：登录界面忘记密码和个人中心修改密码跳转到同一界面

#### 2. 下单功能
- **商品详情页**：利用CSS和JS进行界面美化
- **交互设计**：整个商品卡片变为可点击状态
- **购物车**：通过Ajax添加商品，筛选符合条件的商品展示
- **限制规则**：不支持同一商品重复下单

#### 3. 评论系统
- **评论功能**：买家在商品详情页可对商品进行评论
- **评论展示**：展示卖家和其他买家对于此商品的评论
- **无限评论**：支持无限制评论（利用parent评论和外键实现）
- **评论管理**：用户可删除自己的评论

#### 4. 订单管理
- **实时计算**：订单详情页实时计算并显示总额
- **订单创建**：通过Ajax传递商品ID和数量，后端创建订单
- **订单状态**：
  - 未提交
  - 处理中（用户可取消）
  - 已拒绝（自动退款）
  - 已通过
- **历史订单**：后端使用 `value_list` 获取commodity的queryset

#### 5. 搜索功能
- **简单搜索**：基于数据库查询实现
- **店铺跳转**：从商品详情页跳转到店铺详情页

#### 6. 商品推荐
- **推荐算法**：按照用户点击量倒序推荐商品

#### 7. 个人中心
- **信息展示**：罗列用户基本信息
- **密码修改**：通过旧密码验证，使用MD5加密更新密码
- **隐私处理**：自定义函数对敏感信息进行隐私处理
- **头像上传**：利用form的encrypt参数，通过open函数遍历chunks保存

#### 8. 钱包系统
- **余额管理**：显示个人余额
- **充值功能**：通过Ajax传递参数，字符串转浮点数处理

### 角色2：卖家

#### 1. 鉴权认证
- **注册登录**：与买家类似的功能流程
- **待优化**：邮箱验证码登录功能

#### 2. 店铺与商品管理
- **店铺主页**：卖家的index主页即个人店铺主页
- **分类管理**：卖家设置分类，与商品种类一一对应
- **关键设计**：`store_id` 与 `label` 相同，简化处理逻辑
- **商品发布**：使用Form表单发布新品，涉及名称、原价、现价和库存
- **商品标签**：与店铺标签对接，统一处理
- **商品详情**：使用django-ckeditor富文本编辑器
- **订单处理**：通过Ajax发送操作参数，传递带有orderId的URL

#### 3. 评论处理
- **评论展示**：商品管理页只展示买家对于此商品的评论
- **回复权限**：卖家只可以回复买家的评论

### 角色3：Admin管理员

#### 核心功能
- **管理界面**：提供可视化数据操作界面，类似Navicat

#### 1. 用户管理
- **冻结功能**：为卖家和买家添加 `is_active()` 字段
- **权限控制**：只有激活状态下用户才能进行核心操作

#### 2. 标签管理
- **商品标签**：后台选择和管理商品标签

#### 3. 批量操作
- **批量管理**：实现批量上架和下架选中商品的功能

#### 4. 搜索过滤
- **用户过滤**：买家和卖家分开模型，不支持用户类型过滤
- **商品过滤**：支持商品类型、上架状态过滤，商品名称搜索
- **订单过滤**：支持订单创建时间和处理状态过滤
- **多条件搜索**：支持订单号、商品名、买家名称和卖家名称搜索

---

*项目比较简陋，恳请老师批评指正！*